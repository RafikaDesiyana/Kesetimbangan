<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Simulator Keselamatan Mobil</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>

<style>
body{
  font-family:Arial;
  background:linear-gradient(#bae6fd,#f8fafc);
  text-align:center;
}
.panel{
  background:white;
  width:560px;
  margin:15px auto;
  padding:15px;
  border-radius:14px;
  box-shadow:0 6px 15px rgba(0,0,0,0.2);
}
label{font-weight:bold;display:block;margin-top:10px}
input,select{width:100%;padding:7px;margin-top:5px}
button{
  margin-top:15px;
  padding:10px 20px;
  font-size:16px;
  border-radius:8px;
  border:none;
  cursor:pointer;
}
.start{background:#22c55e;color:white}
.reset{background:#ef4444;color:white;margin-left:10px}
canvas{margin-top:15px;border-radius:12px}
</style>
</head>

<body>
<h1>ðŸš— Simulator Keselamatan Mobil</h1>

<div class="panel">
  <label>Kecepatan (Km/jam)</label>
  <input type="range" id="kecepatan" min="0" max="100" value="40">

  <label>Tekanan Ban</label>
  <select id="tekanan">
    <option value="normal">Normal</option>
    <option value="bocor">Bocor</option>
  </select>

  <label>Kondisi Jalan</label>
  <select id="jalan">
    <option value="normal">Normal</option>
    <option value="licin">Licin</option>
  </select>

  <button class="start" onclick="mulaiSimulasi()">START</button>
  <button class="reset" onclick="resetSimulasi()">RESET</button>
</div>

<script>
let x=60, jalanSimulasi=false, selesai=false, hasil="";
let air=[];

function setup(){
  createCanvas(900,450);
  for(let i=0;i<30;i++){
    air.push({x:random(width), y:random(20), s:random(20,50)});
  }
}

function gambarMobil(px,py,miring,crash){
  push();
  translate(px,py);
  rotate(miring);
  noStroke();

  fill(0,0,0,60);
  ellipse(110,18,210,20);

  fill(crash?120:color(220,38,38));
  rect(10,-35,220,40,18);

  fill(crash?140:color(200,30,30));
  rect(60,-75,120,45,18);

  fill(180,220,255);
  rect(70,-70,45,35,10);
  rect(120,-70,45,35,10);

  for(let i of [55,185]){
    fill(20); ellipse(i,10,34);
    fill(150); ellipse(i,10,18);
  }
  pop();
}

function mulaiSimulasi(){
  x=60; hasil=""; selesai=false; jalanSimulasi=true;
}

function resetSimulasi(){
  x=60; hasil=""; selesai=false; jalanSimulasi=false;
}

function draw(){
  background(230);

  let jalan=document.getElementById("jalan").value;
  let v=int(document.getElementById("kecepatan").value);
  let tekanan=document.getElementById("tekanan").value;
  let kategori=v<=30?"LAMBAT":v<=70?"SEDANG":"LAJU";
  let gesek=jalan==="normal"?0.08:0.02;
  let sp=(v/18)-gesek;
  if(sp<0) sp=0;

  /* ===== JALAN ===== */
  if(jalan==="normal"){
    fill(120); rect(0,350,width,55);
  } else {
    fill(140,180,200); rect(0,350,width,55);
    for(let p of air){
      fill(255,255,255,120);
      ellipse(p.x,p.y+350,p.s,p.s/4);
      p.x+=1.5;
      if(p.x>width) p.x=0;
    }
  }

  if(jalanSimulasi && !selesai) x+=sp;

  if(x>width-260 && !selesai){
    selesai=true;
    if(
      (kategori==="LAJU" && tekanan==="bocor") ||
      (kategori==="LAJU" && jalan==="licin") ||
      (tekanan==="bocor" && jalan==="licin")
    ) hasil="KECELAKAAN";
    else hasil="AMAN";
  }

  /* ===== MOBIL ===== */
  gambarMobil(x,350,tekanan==="bocor"?radians(6):0,hasil==="KECELAKAAN");

  /* ===== PANEL RUMUS (KIRI â€“ SIMETRIS) ===== */
  fill(59,130,246,150);
  rect(30,40,300,150,16);
  fill(255);
  textAlign(CENTER); textSize(16);
  text("RUMUS PERHITUNGAN",180,70);

  textAlign(LEFT); textSize(13);
  text("sp = (v / 18) âˆ’ Î¼",40,100);
  text("v  = kecepatan (km/jam)",40,120);
  text("Î¼  = gaya gesek jalan",40,140);
  text("sp = ("+v+"/18) âˆ’ "+gesek+" = "+sp.toFixed(2),40,160);

  /* ===== PANEL KATEGORI (KANAN â€“ SIMETRIS) ===== */
  fill(59,130,246,150);
  rect(570,40,300,150,16);
  fill(255);
  textAlign(CENTER); textSize(16);
  text("KATEGORI KECEPATAN",720,70);

  fill(kategori==="LAMBAT"?color(34,197,94):255);
  text("LAMBAT : 0â€“30",720,105);
  fill(kategori==="SEDANG"?color(234,179,8):255);
  text("SEDANG : 31â€“70",720,130);
  fill(kategori==="LAJU"?color(239,68,68):255);
  text("LAJU : 71â€“100",720,155);

  /* ===== INFO KONDISI (KIRI BAWAH, TIDAK NUMPUK) ===== */
  fill(0);
  textAlign(LEFT); textSize(14);
  text("Kecepatan : "+v+" km/jam",40,230);
  text("Tekanan Ban : "+tekanan.toUpperCase(),40,250);
  text("Kondisi Jalan : "+jalan.toUpperCase(),40,270);

  /* ===== HASIL (BAWAH TENGAH, AMAN) ===== */
  if(hasil!==""){
    fill(0,0,0,160);
    rect(200,300,500,38,14);

    fill(hasil==="AMAN"?color(16,185,129):color(220,38,38));
    textAlign(CENTER); textSize(18);
    text(
      hasil==="AMAN"
      ?"HASIL: MOBIL BERHENTI DENGAN AMAN"
      :"HASIL: MOBIL MENGALAMI KECELAKAAN",
      450,325
    );
  }
}
</script>
</body>
</html>
